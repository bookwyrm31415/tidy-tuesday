hjust = 1
) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme( plot.margin = margin(0.1, 0.1, 0.1, 0.1, "cm"))
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme( plot.margin = margin(2, 2, 2, 2, "cm"))
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1990, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(plot.margin = margin(2, 2, 2, 2, "cm"))
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1990, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(egend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1990, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1995, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
scale_y_continuous(breaks = seq(1,10,2))
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_y_reverse()
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
scale_y_continuous(breaks = seq(1,10))
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
scale_y_continuous(breaks = seq(1,10))
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse(breaks = seq(1,10)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse(breaks = seq(1,11,2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank())
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse(breaks = seq(1,11,2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
#test for one
ggplot(ranked, aes(x = year, y = rank, color = winner)) + geom_bump() + scale_y_reverse(breaks = seq(1,11,2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_color_grey()
winners <- mutate(colour = ifelse(winner == "New Zealand", "green", "gray30"))
winners <- winners %>%mutate(colour = ifelse(winner == "New Zealand", "green", "gray30"))
#test for one
ggplot(ranked, aes(x = year, y = rank, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup()
#test for one
ggplot(ranked, aes(x = year, y = rank, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
winners <- winners %>%mutate(color = ifelse(winner == "New Zealand", "green", "gray30"))
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup()
#test for one
ggplot(ranked, aes(x = year, y = rank, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
#Loads in the matches
matches <-
read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-11-30/matches.csv"
)
matches <-
matches %>% mutate(year = format(as.Date(match_date, format = "%b %d, %Y"), "%Y")) %>% mutate(year = as.numeric(year))
winners <-
matches %>% group_by(winner, year) %>% count(winner) %>% drop_na() %>% filter(winner %in% matches$ground_country)
winners <- winners %>%mutate(color = ifelse(winner == "New Zealand", "green", "gray30"))
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup()
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) + scale_fill_grey()
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup() %>% filter(rank<= 10)
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup() %>% filter(rank<= 5)
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
test <- ranked %>% filter(winner %in% c("New Zealand", "Australia"))
#test for one
ggplot(test, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
ranked <-
winners %>% group_by(year) %>% mutate(rank = rank(desc(n), ties.method = "random")) %>% ungroup() %>% filter(rank<= 10)
test <- ranked %>% filter(winner %in% c("New Zealand", "Australia"))
#test for one
ggplot(test, aes(x = year, y = rank,group = winner, color = color)) + geom_bump() + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
#test for one
ggplot(test, aes(x = year, y = rank,group = winner, color = color)) + geom_bump(size = 1) + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
#test for one
ggplot(test, aes(x = year, y = rank,group = winner, color = color)) + geom_bump(size = 1) + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = ranked %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = ranked %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
#test for one
ggplot(test, aes(x = year, y = rank,group = winner, color = color)) + geom_bump(size = 1) + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = test %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = test %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
#test for one
ggplot(ranked, aes(x = year, y = rank,group = winner, color = color)) + geom_bump(size = 1) + scale_y_reverse(breaks = seq(1, 11, 2)) + geom_text(
data = test %>% filter(year == min(year)),
aes(x = year - .1, label = winner),
size = 5,
hjust = 1
) +
geom_point(aes(group=winner),size=3,show.legend = FALSE)+
scale_x_continuous(limits = c(1994, 2007),
breaks = seq(1995, 2005, 1)) +
geom_text(
data = test %>% filter(year == max(year)),
aes(x = year + .1, label = winner),
size = 5,
hjust = 0
) +
theme_minimal_grid(font_size = 14, line_size = 0) + theme(legend.position = "none",
panel.grid.major = element_blank()) +  scale_color_manual(values=c("gray30","#0392cf"))
